/*marketgid.comV3*/if(!this.MarketGidJSON){ MarketGidJSON=function(){function f(n){return n<10?'0'+n:n;}Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z';};var m={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case'string':return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c;}c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"':'"'+value+'"';case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}if(typeof value.toJSON==='function'){return stringify(value.toJSON());}a=[];if(typeof value.length==='number'&&!(value.propertyIsEnumerable('length'))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||'null');}return'['+a.join(',')+']';}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}else{for(k in value){if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}return'{'+a.join(',')+'}';}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==='object'){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n;}}}}return filter(k,v);}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof filter==='function'?walk('',j):j;}throw new SyntaxError('parseJSON');}};}();}MarketGidBaseBlockC12314 = function(root_id, DF, fallback, containerId) { var self = this; this.DF = DF; this.root = this.DF.document.getElementById(root_id); this.containerId = containerId; this.EA = fallback; this.page = 1; this.iteration = 1; this.adlink = ''; this.template = ''; this.id = 12314; this.tickerShow = 0; this.AN = []; this.WZ = {}; this.LX = {}; this.WJ = []; this.ET = []; this.YY = []; this.PE = ""; this.TZ = ""; this.KE = 0; this.OV = {}; this.GV = ""; this.DH = ""; this.XD = []; this.crashStep = 0; this.loadedDefault = false; this.teaserHashes = {}; this.teaserData = {}; this.OJ = 2; this.YL = 0; this.fakeMode = 0; this.requestParams = {}; this.infIds = []; this.QT = []; this.realIds = []; this.realUids = []; this.protocols = []; this.VM = []; this.QT['news5726'] = 'ab'; this.VM['news'] = 'ab'; this.XD['news'] = "mgid.com"; this.GJ = '5726'; this.KH = 'news'; this.infIds['news'] = '5726'; this.realIds['news'] = '5726'; this.realUids['news'] = '69822'; this.protocols['news'] = '5'; this.QT['goods3617'] = 'ad'; this.VM['goods'] = 'ad'; this.XD['goods'] = "mgid.com"; this.GJ = '3617'; this.KH = 'goods'; this.infIds['goods'] = '3617'; this.realIds['goods'] = '3617'; this.realUids['goods'] = '30491'; this.protocols['goods'] = '5'; self.templateTextNews = '<div class="mgbox">{foreach} {if this.iteration != 1}</div>{/if}<div class="mgline"> <div class="image-with-text"> <div class="mcimg"> <a {$target} {$href} ><img class="mcimg" {$src}></a> </div> <div class="text-elements"> <div class="mctitle"><a {$target} {$href}>{$title}</a></div> </div> </div> {/foreach} </div></div>'; self.templateTextGoods = '<div class="mgbox">{foreach} {if this.iteration != 1}</div>{/if}<div class="mgline"> <div class="image-with-text"> <div class="mcimg"> <a {$target} {$href} ><img class="mcimg" {$src}></a> </div> <div class="text-elements"> <div class="mctitle"><a {$target} {$href}>{$title}</a></div> </div> </div> {/foreach} </div></div>'; self.stylesNews = '.mgbox *{ -moz-transition:all 0.2s ease; -webkit-transition:all 0.2s ease;} .mgbox { padding: 0 !important; position: relative !important; text-align: center; vertical-align: top !important; margin:0 auto; border-style: solid; max-width: 1000px; border-width: 0px; line-height: 100%; } div.mcimg { padding: 0px; text-align: center; } img.mcimg { border:0px; max-width: 200px; min-width: 140px; width: 100%; height: auto; box-sizing: border-box; margin: auto; } .mgl {text-align:left; color:#444444; padding:5px 0 5px 10px; font-family:verdana; font-weight: bold; font-size:18px; box-sizing: border-box; margin: 5px 0; } .mctitle a { font-weight: 700; font-size: 16px; line-height: 18px; font-style: normal; text-decoration: none; font-family: "Open Sans",sans-serif; color: #006699; } .mcdesc a { font-weight:400; font-size:11px; text-decoration:none !Important; font-family: \'Lato\',Tahoma,Geneva; color:#444;} .mgbox .text-elements { text-align: center; } .mgline:hover a { text-decoration:none; color:#ffffff; } .mgline{ background: none; width: 22.5%; margin: 0.5%; cursor: pointer; display: inline-block !important; vertical-align: top; min-width: 140px; margin-bottom: 5px; padding: 4px; } .mgline:hover{ background: #006699 !important; } div.mctitle{margin-top: 2px; } .mcprice { color:red; font-family: inherit !important; text-decoration:none !important; display: inline-block;} div.mcprice { text-align: center; } div.mcprice span { font-size: 12px; font-weight: bold; font-style: normal; color: #ff0000; } div.mcprice > span { text-decoration: none; } span.mcpriceold { text-decoration: line-through !important; }'; self.stylesGoods = '.mgbox *{ -moz-transition:all 0.2s ease; -webkit-transition:all 0.2s ease;} .mgbox { padding: 0 !important; position: relative !important; text-align: center; vertical-align: top !important; margin:0 auto; border-style: solid; max-width: 1000px; border-width: 0px; line-height: 100%; } div.mcimg { padding: 0px; text-align: center; } img.mcimg { border:0px; max-width: 200px; min-width: 140px; width: 100%; height: auto; box-sizing: border-box; margin: auto; } .mgl {text-align:left; color:#444444; padding:5px 0 5px 10px; font-family:verdana; font-weight: bold; font-size:18px; box-sizing: border-box; margin: 5px 0; } .mctitle a { font-weight: 700; font-size: 16px; line-height: 18px; font-style: normal; text-decoration: none; font-family: "Open Sans",sans-serif; color: #006699; } .mcdesc a { font-weight:400; font-size:11px; text-decoration:none !Important; font-family: \'Lato\',Tahoma,Geneva; color:#444;} .mgbox .text-elements { text-align: center; } .mgline:hover a { text-decoration:none; color:#ffffff; } .mgline{ background: none; width: 22.5%; margin: 0.5%; cursor: pointer; display: inline-block !important; vertical-align: top; min-width: 140px; margin-bottom: 5px; padding: 4px; } .mgline:hover{ background: #006699 !important; } div.mctitle{margin-top: 2px; } .mcprice { color:red; font-family: inherit !important; text-decoration:none !important; display: inline-block;} div.mcprice { text-align: center; } div.mcprice span { font-size: 12px; font-weight: bold; font-style: normal; color: #ff0000; } div.mcprice > span { text-decoration: none; } span.mcpriceold { text-decoration: line-through !important; }'; self.isOurRedirector = '0'; self.webProtocol = "http:"; self.clickTracking = ""; self.SH = ''; self.funcBlocks = {}; self.teaserData = {}; self.loadedPopularTeaser = false; self.deviceType = "desktop"; this.SW = function(str,limit) { if (str.length<=limit) return str; var word=new Array(); word=str.split(" "); var ret=word[0] + ' '; var test; for (i=1;i<word.length;i++){ test=ret+word[i]; if (test.length>limit) return ret+'...'; else ret+=word[i] + ' '; } return str; }; this.AW = function(str,limit){ var word=new Array(); var i; var ret=''; word=str.split(" "); for (i=0;i<word.length;i++){ if (word[i].length>limit && word[i].search(/&\w+;/)<0) ret+=word[i].substr(0,limit) + ' ' + word[i].substr(limit) + ' '; else ret+=word[i] + ' '; } return ret; }; this.GI = function(title) { if (this.SH=='news') { title=this.SW(title,60); } else { title=this.SW(title,60); } return title; }; this.ZV = function(desc) { if (this.SH=='news') { desc=this.SW(desc,120); } else { desc=this.SW(desc,60); } return desc; }; this.isArray = function(o) { return Object.prototype.toString.call(o) === '[object Array]'; }; self.fixGetElementsByClassNameHandler = function(el) { if (el.getElementsByClassName == undefined) { el.getElementsByClassName = function(cl) { var retnode = []; var myclass = new RegExp('\\b'+cl+'\\b'); var elem = this.getElementsByTagName('*'); for (var i = 0; i < elem.length; i++) { var classes = elem[i].className; if (myclass.test(classes)) retnode.push(elem[i]); } return retnode; }; } }; this.OT = function() { if (!this.EA && this.DF.document.getElementById("MarketGidPreloadC" + this.containerId)) { this.DF.document.getElementById("MarketGidPreloadC" + this.containerId).style.display = 'none'; } else if (this.EA && this.KE == 0) { this.root.innerHTML = ""; } }; this.MarketGidLoadNews = function(json, otherParams) { this.OT(); if (typeof otherParams != 'undefined' && typeof otherParams.dt != 'undefined') { self.deviceType = otherParams.dt; } if (self.fakeMode == 0) { for (var i = 0; i < self.WJ.length; i++) { self[self.WJ[i]](); } } if (this.isArray(json)){ if (json.length==0) { if (!this.forceShow) { this.blockType = this.blockType == 'news' ? 'goods' : 'news'; var type = this.blockType; var id = this.realIds[type]; this.blockId = id; this.subdomain = this.QT[type + id]; this.WZ["mg_id"] = id; this.WZ["mg_type"] = type; this.setCookie(); this.forceShow = true; this.PE = '//'+self.subdomain+'-'+self.blockType.substr(0,1)+'b.'+self.XD[self.blockType]+'/'; this.WG(this.forceShow); } return; } if (self.SH == "news") { var template = self["templateFuncNews"](self, json); } else { var template = self["templateFuncGoods"](self, json); } if (this.root && template) { if (typeof self.parseAdvertLink == 'function') { template = self.parseAdvertLink(template); } if (this.EA && this.KE == 0) { this.root.innerHTML = "" } this.root.innerHTML += this.GV + template + this.DH; } } else { if (this.root && this.KE==0) { this.root.innerHTML=''; return; } } this.WZ["page"] = this.page; this.WZ['time'] = (new Date()).getTime(); this.setCookie(); var hrefs = this.root.getElementsByTagName("a"); for (var i = 0; i < hrefs.length; i++) { } if (this.SH=='news') { this.ML(self.stylesNews); } else { this.ML(self.stylesGoods); } this.KE++; if (self.fakeMode == 0) { for (var i = 0; i < self.ET.length; i++) { self[self.ET[i]](); } } else { if (typeof(self.responsiveInit) == "function") { self.responsiveInit(); } } }; this.SR = function() { var d = this.DF.document, w = this.DF, dE = 'documentElement', cH = 'clientHeight', cW = 'clientWidth', iH = 'innerHeight', iW = 'innerWidth', sH = 'scrollHeight', sW = 'scrollWidth', oH = 'offsetHeight', oW = 'offsetWidth', oL = 'offsetLeft', oT = 'offsetTop', sT = 'scrollTop', sL = 'scrollLeft'; if (w[iW]) { return {"c": w[iH], "s": w.pageYOffset}; } else if (d[dE] && d[dE][cW]) { return {"c": d[dE][cH], "s": d[dE][sT]}; } else if (d.body[cW]) { return {"c": d.body[cH], "s": d.body[sT]}; } return 0; }; this.MarketGidRedirectComposite = function() { if (arguments.length == 5) { var arr = arguments[4]; } else { var arr = arguments[0]; } if (self.crashWorkerTimeout) { clearTimeout(self.crashWorkerTimeout); } if (self.YL >= self.OJ || self.crashStep == 2) { self.SH = self.blockType; self.MarketGidLoadNews(arr); } else { var rType = self.blockType == 'news' ? 'goods' : 'news'; var rId = self.realIds[rType]; if (self.QT[rType + rId]) { if (self.crashStep == 1) self.crashStep++; if (typeof self.isDrawRedirect != 'undefined') { self.isDrawRedirect = true; } self.blockId = rId; self.blockType = rType; self.subdomain = self.QT[rType + rId]; self.WZ["mg_id"] = rId; self.WZ["mg_type"] = rType; self.setCookie(); self.PE = '//'+self.subdomain+'-'+self.blockType.substr(0,1)+'b.'+self.XD[self.blockType]+'/'; self.WG(self.YL >= (self.OJ - 1)); self.YL++; } } }; this.crashWorker = function() { if (MarketGidInfC12314.template == '' && !MarketGidInfC12314.loadedDefault) { MarketGidInfC12314.crashStep = 1; MarketGidInfC12314.MarketGidRedirectComposite([]); } }; this.renderItem = function(n, callbackText, type) { if (self.isArray(n)) { var p = self.VX(n, type); if (!(p.id in self.OV) && p.id != '') { if (typeof p.hash !== 'undefined' && typeof p.id !== 'undefined') { self.teaserHashes[p.id] = p.hash; } self.OV[p.id] = 1; var addClasses = []; if (!self.loadedPopularTeaser && typeof(p.other.adc) != 'undefined' && ( p.other.adc.toString().indexOf('mrsadca') >= 0 || p.other.adc.toString().indexOf('mrsadcp') >= 0 )) { addClasses.push('mgpopular'); self.loadedPopularTeaser = true; } addClasses.push('teaser-' + p.id); if ('l' in p.other && null != p.other.l.match(/[\?|&]u=/)) { addClasses.push('dsp'); } var vars = [ [/\{\*.*?\*\}/, ''], [/\{\$href\}/g, 'href="' + self.JT(p.hash) + '" data-hash="' + p.hash + '"'], [/\{\$pmc_item\}/, self.id], [/\{\$target\}/g, 'target="_blank"'], [/(class\=\"[^+]?)(mgline)([^+]?\")/, '$1$2 ' + addClasses.join(' ') + '$3'], [/\{\$source\}/g, p.source], [/\{\$src\}/g, (type == 'news' ? 'width="200" height="200"' : 'width="200" height="200"') + ' data-i="'+p.id+'" src="'+ p.other["i"]+'"'], [/\{\$title\}/g, self.GI(p.title)], [/\{\$desc\}/g, self.ZV(p.desc)], [/\{\$iteration\}/g, self.iteration], [/\$iteration/g, self.iteration], [/this\.iteration/g, self.iteration], [/\{\$price\}/g, p.price], [/\{\$priceold\}/g, p.priceold], [/\{\$discount\}/g, p.discount], [/\{if \$price\}/g, "{if '' != p.price.replace(new RegExp('[^0-9.]'), '')}"], [/\{if !\$price\}/g, "{if '' == p.price.replace(new RegExp('[^0-9.]'), '')}"], [/\{if \$priceold\}/g, "{if '' != p.priceold.replace(new RegExp('[^0-9.]'), '')}"], [/\{if \$price != " "\}/g, "{if p.price != ' '}"], [/\{if \$price == " "\}/g, "{if p.price == ' '}"], [/\$priceold/g, p.priceold], [/\$price/g, p.price], [/\{if \$rep\}/g, "{if p.isReplic}"] ]; for (var i = 0 ; i < vars.length; i++) { callbackText = callbackText.replace(vars[i][0], vars[i][1]); } while (true) { var x = callbackText; var r = /\{if ([^\}]*?)\}(((?!\{(?:\/)?if).)*)\{\/if\}/g; callbackText = callbackText.replace(r, function(str, p1, p2) { if (eval(p1)) { return p2; } else { return ""; } }); if (x == callbackText) break; } this.iteration++; return callbackText; } else { self.OV[p.id]++; return ""; } } }; this.generateTemplate = function(templateText, type) { self["templateText" + type] = templateText; self["templateFunc" + type] = function(inf, json) { var parts = /(.*)?\{foreach\}(.*)?\{\/foreach\}(.*)?/.exec(self["templateText" + type]); var template = typeof(parts[1]) != 'undefined' ? parts[1] : ''; for (var i = 0; i < json.length; i++) { template += inf.renderItem(json[i], parts[2], type); } template += typeof(parts[3]) != 'undefined' ? parts[3] : ''; return template; }; return true; }; this.init = function() { if (this.root) { this.getCookie(); var cookiePage = parseInt(this.WZ["page"]); this.AN = this.root.getElementsByTagName('a'); var pageOffset = (this.DF['MarketGidPageOffset'] ? parseInt(this.DF['MarketGidPageOffset']) : 0); self.addEvent(self.root, 'click', self.hangNiceLinkListener); self.addEvent(self.root, "\x63\x6f\x6e\x74\x65\x78\x74menu", self.hangNiceLinkListener); self.addEvent(self.root, 'mouseup', self.hangNiceLinkListener); self.addEvent(self.root, 'touchstart', self.hangNiceLinkListener); var tmpType = this.WZ["mg_type"] ? this.WZ["mg_type"] : this.KH; var pagesCountNews = parseInt('20'); var pagesCountGoods = parseInt('20'); var pagesCount = (tmpType == 'news') ? pagesCountNews : pagesCountGoods; if (cookiePage != null && cookiePage < pagesCount && cookiePage > 0 ) { this.page = cookiePage + 1; } else if (cookiePage > (pagesCount - 1) || cookiePage < 1 ) { this.page = 1 + pageOffset; } if ((new Date()).getTime() - (this.WZ['time']!=undefined ? this.WZ['time'] : 0) >= 6e5) { this.page = 1+pageOffset; } if (!this.page) this.page=1; this.pageUnlim = this.page - 1; this.WZ["page"] = this.page; this.setCookie(); if (!this.DF.document.cookie) { var dt = new Date(); this.page = dt.getSeconds()%pagesCount+1; } this.blockId = this.WZ["mg_id"] ? this.WZ["mg_id"] : this.GJ; this.blockType = this.WZ["mg_type"] ? this.WZ["mg_type"] : this.KH; if (this.QT[this.blockType + this.blockId]) this.subdomain = this.QT[this.blockType + this.blockId]; else { this.subdomain = this.VM[this.KH]; this.blockId = this.GJ; this.blockType = this.KH; } this.PE = '//'+this.subdomain+'-'+this.blockType.substr(0,1)+'b.'+this.XD[this.blockType]+'/'; var protocol = self.DF.document.location.protocol; self.webProtocol = protocol.indexOf("http") != -1 ? protocol : "http:"; self.clickTracking = typeof(self.DF.MGClickTracking) != 'undefined' ? self.DF.MGClickTracking : ""; if (!self.generateTemplate(self.templateTextNews, 'News') || !self.generateTemplate(self.templateTextGoods, 'Goods')) { return; } self.DF.onClickExcludes = self.DF.onClickExcludes || []; self.DF.onClickExcludes.push(self.root); for (var i=0; i<this.YY.length; i++) { this[this.YY[i]](); } } }; this.WG = function(forceShow, refresh) { var script = this.DF.document.createElement('script'); script.type = 'text/javascript'; script.charset = 'utf-8'; var uid = this.blockType == 'news' ? "69822" : "30491"; var scriptSrc = ""; var fs = forceShow ? 'fs/' : ''; scriptSrc += self.PE + fs + 'u' + uid + '/' + this.blockId+'/' + this.page; if (refresh) { self.requestParams.rsh = "rsh=1"; } if (this.DF.MGi != undefined) { self.requestParams.geo = "geo=" + this.DF.MGi; } self.requestParams.pv = "pv=" + this.protocols[this.blockType]; self.requestParams.cbuster = "cbuster=" + (this.DF.MG_CacheBuster ? this.DF.MG_CacheBuster : ((new Date().getTime()) + '' + Math.floor((Math.random() * 1000000000) + 1))); if (scriptSrc.indexOf('?') == -1) { scriptSrc += '?'; } else { scriptSrc += '&'; } var params = []; for (var key in self.requestParams) { params.push(self.requestParams[key]); } params.push('ref=' + encodeURIComponent(this.DF.document.referrer)); if (self.DF.self !== self.DF.top) { params.push('iframe=1'); } scriptSrc += params.join("&"); script.src = scriptSrc; (this.realRoot != undefined ? this.realRoot : this.root).parentNode.appendChild(script); script.onerror = function () { if (typeof(mg_ws)=="object" && mg_ws instanceof WebSocket){ mg_ws.onmessage = function(evt){self.DF.eval(evt.data)}; sendMessage('gb|'+script.src); } }; }; this.ML = function(style, container) { style = style.replace(/((?:^|}|,)\W*)((?:\w+)?\.(?:mc|mg)[\-\w]+)/g, "$1" + this.getMainCssSelector() + " $2"); if (style == "") return; if (!container) { var MGst = container ? container : this.DF.document.createElement('style'); MGst.className = 'MarketGidC12314'; MGst.type = 'text/css'; (this.realRoot != undefined ? this.realRoot : this.root).parentNode.appendChild(MGst); if (MGst.styleSheet) { MGst.styleSheet.cssText = style; } else { MGst.appendChild(this.DF.document.createTextNode(style)); }; } else { var MGst = container; MGst.className = 'MarketGidC12314'; if (MGst.styleSheet) { MGst.styleSheet.cssText = style; } else { while (MGst.firstChild) { MGst.removeChild(MGst.firstChild); } MGst.appendChild(this.DF.document.createTextNode(style)); }; } }; this.start = function() { if (self.root && self.KE == 0) { self.WG(); } }; this.addEvent = function(elem, type, handler) { if (elem.addEventListener) { elem.addEventListener(type, handler, false) } else { elem.attachEvent('on' + type, handler) } }; this.getMainCssSelector = function() { return "#" + (this.realRoot ? this.realRoot.id : this.root.id); }};var mgCanLoad12314 = false;var mgFallback12314 = false;if (document.getElementById("MG_ID")) mgCanLoad12314 = true;if (document.getElementById("MarketGidComposite12314")) { mgCanLoad12314 = true; mgFallback12314 = true;}if (this['mgCanLoad12314']) { if (!mgFallback12314) { var rootId12314 = document.getElementById("MG_ID").innerHTML; var div12314 = parent.window.document.createElement('div'); div12314.id = "MarketGidComposite12314"; parent.window.document.getElementById("MarketGidScriptRootC" + rootId12314).appendChild(div12314); MarketGidInfC12314 = new MarketGidBaseBlockC12314("MarketGidComposite12314", parent.window, false, rootId12314); } else { MarketGidInfC12314 = new MarketGidBaseBlockC12314("MarketGidComposite12314", window, true, 0); } this['MarketGidCMainBlock12314'] = function(self) { self.BH = function(hash, event, element) { var href = self.clickTracking + self.webProtocol; var data = self.teaserData[hash]; if (data) { if (data.link) { href += data.link; } else { if (data.type.toLowerCase() == 'news') { var id = self.id; if ('C' == 'C') { id = '5726'; } href += '//' + data.mirror + '/' + (self.isOurRedirector == '1' ? 'rnews' : 'pnews') + '/'; href += data[1] + '/i/' + id + '/pp/' + self.iteration + '/' + self.page + '/?h=' + encodeURIComponent(hash); } else { href += '//' + data.mirror + '/ghits/?h=' + encodeURIComponent(hash); } } } else { href = "#"; } if (typeof self.WT == 'function') { var afParams = self.WT(event, element); if (afParams) { var suffix = '12314'; href += ((href.indexOf('?') >= 0) ? '&' : '?') + 'k=' + suffix + 'f' + afParams; } } if (true == parseInt('0')) { var template = '//%host%/r/%title%?u=%rurl%'; template = template.replace(/^(\/\/)/, self.DF.location.protocol + '$1'); template = template.replace(/(%host%)/, self.DF.location.host); template = template.replace(/(%title%)/, self.UK(data[3])); href = template.replace(/(%rurl%)/, self.BE(href, true)); } return href; }; self.JT = function(hash, event, element) { var href; var data = self.teaserData[hash]; if (data.other['sdl'] == 1) { href = self.clickTracking; if (typeof(data.other['dl']) != 'undefined' && data.other['dl'] != '') { href += data.other['dl']; } else { var source = decodeURIComponent(data[0]).replace(/[`|'\.,:\/?;$%&\(\)^*!@\s]/g, '').toLowerCase(); var title = decodeURIComponent(data[3]).replace(/\s/g, '_').replace(/[`|'\.,:\/?;$%&\(\)^*!@]/g, ''); href += self.webProtocol + '//' + (source ? source + '/' : '') + title; } } else { href = self.BH(hash, event, element); } return href; }; self.UK = function(str) { var a = { 'Ё':'YO','Й':'I','Ц':'TS','У':'U','К':'K','Е':'E','Н':'N','Г':'G','Ш':'SH','Щ':'SCH', 'З':'Z','Х':'H','Ъ':'','ё':'yo','й':'i','ц':'ts','у':'u','к':'k','е':'e','н':'n', 'г':'g','ш':'sh','щ':'sch','з':'z','х':'h','ъ':'\'','Ф':'F','Ы':'I','В':'V','А':'a', 'П':'P','Р':'R','О':'O','Л':'L','Д':'D','Ж':'ZH','Э':'E','ф':'f','ы':'i','в':'v','а':'a', 'п':'p','р':'r','о':'o','л':'l','д':'d','ж':'zh','э':'e','Я':'Ya','Ч':'CH','С':'S', 'М':'M','И':'I','Т':'T','Ь':'','Б':'B','Ю':'YU','я':'ya','ч':'ch','с':'s','м':'m', 'и':'i','т':'t','ь':'','б':'b','ю':'yu',' ':'_', 'і':'i', 'І':'I', 'ї':'i', 'Ї':'I' }; return str.split('').map(function (char) { if (char.match(/[a-z0-9_\-]/i)) { return char; } return a[char] || ''; }).join(''); }; self.getParentLink = function(el) { while (el.tagName !== 'BODY') { if (el.tagName == "A") { return el; } else { el = el.parentNode; } } return null; }; self.VX = function(data, type) { var t = {}; t.source = data[0]; t.id = data[1]; t.title = data[3]; t.desc = data[4]; if (type.toLowerCase() == 'news') { t.mirror = data[5] ? data[5] : self.EYs[self.FD]; t.hash = data[6]; t.other = data[7]; } else { t.mirror = self.EYs[self.FD]; t.key = data[6]; t.price = data[7].replace(".00", ""); t.priceold = data[8].replace(".00", ""); t.discount = t.priceold.replace(new RegExp('[^0-9.]'), '') == '' ? '' : Math.floor((1 * /\d+(?:\.\d+)?/.exec(t.priceold) - 1 * /\d+(?:\.\d+)?/.exec(t.price)) * 100 / /\d+(?:\.\d+)?/.exec(t.priceold)) + '%'; t.hash = data[9]; t.other = data[10]; var titleLower = t.title.toLowerCase(); var descLower = t.desc.toLowerCase(); var replicWords = ["копия", "подделка", "реплика", "как оригинал"]; var replicInsertWords = ["Копия. ", "Реплика. "]; if (data[5] == '1') { t.isReplic = true; for (var i = 0; i < replicWords.length; i++) { if (self.GI(titleLower).indexOf(replicWords[i]) > -1 || self.ZV(descLower).indexOf(replicWords[i]) > -1) { t.isReplic = false; break; } } } else { t.isReplic = false; } } if (self.deviceType != 'desktop') { t.other.sdl = 0; } data['other'] = t.other; self.teaserData[t.hash] = data; self.teaserData[t.hash]['img'] = t.other["i"]; self.teaserData[t.hash]['type'] = type; self.teaserData[t.hash]['link'] = typeof(t.other['l']) != 'undefined' ? t.other['l'] : null; self.teaserData[t.hash]['mirror'] = t.mirror; return t; }; self.BE = function(s, replaceChars) { replaceChars = typeof replaceChars == 'undefined' ? replaceChars : false; var b64c = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='; var b64e = ''; var c1, c2, c3, e1, e2, e3, e4; var i = 0; while (i < s.length) { c1 = s.charCodeAt(i++); c2 = s.charCodeAt(i++); c3 = s.charCodeAt(i++); e1 = c1 >> 2; e2 = ((c1&3) << 4) | (c2 >> 4); e3 = isNaN(c2) ? 64 : (((c2&15) << 2) | (c3 >> 6)); e4 = isNaN(c3) ? 64 : (c3&63); b64e += b64c.charAt(e1) + b64c.charAt(e2) + b64c.charAt(e3) + b64c.charAt(e4); } if (true == replaceChars) { b64e = b64e.replace('+', '-').replace('/', '_').replace('=', '*'); } return b64e; }; self.hangNiceLinkListener = function(event) { if (!event) { var event = self.DF.event; } if (!event.target) { event.target = event.srcElement; } var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } var hash = element['data-hash'] || element.getAttribute('data-hash'); if (hash != undefined) { if (typeof self.teaserData[hash]['other']['sdl'] != 'undefined') { self.teaserData[hash]['other']['sdl'] = 0; } element.href = self.BH(hash, event, element); } };}; this['MarketGidCMainBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Main'] = 'MarketGidCMainBlock12314'; MarketGidCCookieBlock12314 = function(self){ this.storageName = "MarketGidStorage" + (this.DF.MarketGidPageOffset ? this.DF.MarketGidPageOffset : ""); this.ZK = function() { var matches = this.DF.document.cookie.match(new RegExp("(?:^|; )" + this.storageName + "=([^;]*)")); var res = {}; if (matches) { try { res = MarketGidJSON.parse(decodeURIComponent(matches[1])); } catch (e) {}; } return res; }; this.getCookie = function() { var value = this.ZK(); if (value["C12314"]!=undefined) { this.WZ = value["C12314"]; } else this.WZ = {}; if (value["0"]!=undefined) { this.LX = value["0"]; } else this.LX = {}; }; this.setCookie = function() { var totalCookie = this.ZK(); totalCookie["C12314"] = this.WZ; totalCookie["0"] = this.LX; var value = encodeURIComponent(MarketGidJSON.stringify(totalCookie)); this.DF.document.cookie = this.storageName+"="+value+";path=/"; }; }; this['MarketGidCCookieBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Cookie'] = 'MarketGidCCookieBlock12314'; MarketGidCSubnetsBlock12314 = function() { var self = this; self.funcBlocks["Subnets"] = "MarketGidCSubnetsBlock12314"; this.YY.push("WU"); this.FD = ""; this.EYs = {}; this.EYServicers = {}; this.EYsImages = {}; this.EYsAdvert = {}; this.EYsAdLinkBlocks = {}; this.EYsUtm = {}; this.subnetDashboardDomains = {}; this.EYNames = {}; this.EYs['0'] = 'mgid.com'; this.EYServicers['0'] = 'mgid.com'; this.EYNames['marketgid'] = parseInt('0'); this.EYsImages['0'] = 'mgid.com'; this.EYsAdLinkBlocks['0'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id"><a href="http://mgid.com/advertisers%utm%id" target="_blank"> by <img style="display: inherit!important;width: auto!important;" src="//mgid.com/images/mgid_logo_mini_43x20.png" alt="Mgid" title="Mgid"></a></div></div><style>.mghead{font-weight:700;font-size:14px;text-transform:uppercase;text-align:left;font-family: "Open Sans", sans-serif;color:#4555a7;display:block;margin:0 0 0px 5px;float:left;}.mgheader{ display: table !Important; width: 100% !important;}div.mg_addad%id{text-align: right; opacity: 0.5;margin-right: 10px} div.mg_addad%id:hover{opacity: 1} div.mg_addad%id a{color: #000000; font:normal 10px Myriad Pro; text-decoration: none;} div.mg_addad%id img{margin-bottom: -5px; border:0px}</style>'; this.EYsUtm['0'] = '?utm_source=widget&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['0'] = '//dashboard.mgid.com'; this.EYs['1'] = 'fem.mgid.com'; this.EYServicers['1'] = 'mgid.com'; this.EYNames['lady'] = parseInt('1'); this.EYsImages['1'] = 'mgid.com'; this.EYsAdLinkBlocks['1'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id"><a href="http://mgid.com/advertisers%utm%id" target="_blank"> by <img style="display: inherit!important;width: auto!important;" src="//mgid.com/images/mgid_logo_mini_43x20.png" alt="Mgid" title="Mgid"></a></div></div><style>.mghead{font-weight:700;font-size:14px;text-transform:uppercase;text-align:left;font-family: "Open Sans", sans-serif;color:#4555a7;display:block;margin:0 0 0px 5px;float:left;}.mgheader{ display: table !Important; width: 100% !important;}div.mg_addad%id{text-align: right; opacity: 0.5;margin-right: 10px} div.mg_addad%id:hover{opacity: 1} div.mg_addad%id a{color: #000000; font:normal 10px Myriad Pro; text-decoration: none;} div.mg_addad%id img{margin-bottom: -5px; border:0px}</style>'; this.EYsUtm['1'] = '?utm_source=widget_fem&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['1'] = '//dashboard.mgid.com'; this.EYs['2'] = 'adskeeper.co.uk'; this.EYServicers['2'] = 'adskeeper.co.uk'; this.EYNames['adskeeper'] = parseInt('2'); this.EYsImages['2'] = 'adskeeper.co.uk'; this.EYsAdLinkBlocks['2'] = '<div class="mg_addad%id widgets_logo"><a href="http://adskeeper.co.uk/#1" target="_blank"><img src="//adskeeper.co.uk/logo_adskeeper_s.png" alt="Adskeeper" title="Adskeeper"></a></div><style type="text/css">div.mg_addad%id{text-align: right; opacity: 0.5;} div.mg_addad%id:hover{opacity: 1} div.mg_addad%id a{color: #000000; font:normal 10px Myriad Pro; text-decoration: none;} div.mg_addad%id img{margin-bottom: -5px; border:0px}</style>'; this.EYsUtm['2'] = '?utm_source=widget_adskeeper&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['2'] = '//dashboard.adskeeper.co.uk'; this.EYs['3'] = 'mgid.com'; this.EYServicers['3'] = 'mgid.com'; this.EYNames['marketgid'] = parseInt('3'); this.EYsImages['3'] = 'mgid.com'; this.EYsAdLinkBlocks['3'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id"><a href="http://mgid.com/advertisers%utm%id" target="_blank"> by <img style="display: inherit!important;width: auto!important;" src="//mgid.com/images/mgid_logo_mini_43x20.png" alt="Mgid" title="Mgid"></a></div></div><style>.mghead{font-weight:700;font-size:14px;text-transform:uppercase;text-align:left;font-family: "Open Sans", sans-serif;color:#4555a7;display:block;margin:0 0 0px 5px;float:left;}.mgheader{ display: table !Important; width: 100% !important;}div.mg_addad%id{text-align: right; opacity: 0.5;margin-right: 10px} div.mg_addad%id:hover{opacity: 1} div.mg_addad%id a{color: #000000; font:normal 10px Myriad Pro; text-decoration: none;} div.mg_addad%id img{margin-bottom: -5px; border:0px}</style>'; this.EYsUtm['3'] = '?utm_source=widget&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['3'] = '//'; this.EYs['4'] = 'mgid.com'; this.EYServicers['4'] = 'mgid.com'; this.EYNames['marketgid'] = parseInt('4'); this.EYsImages['4'] = 'mgid.com'; this.EYsAdLinkBlocks['4'] = '<div class="mgheader"><span class="mghead">%WIDGET_TITLE%</span><div class="mg_addad%id"><a href="http://mgid.com/advertisers%utm%id" target="_blank"> by <img style="display: inherit!important;width: auto!important;" src="//mgid.com/images/mgid_logo_mini_43x20.png" alt="Mgid" title="Mgid"></a></div></div><style>.mghead{font-weight:700;font-size:14px;text-transform:uppercase;text-align:left;font-family: "Open Sans", sans-serif;color:#4555a7;display:block;margin:0 0 0px 5px;float:left;}.mgheader{ display: table !Important; width: 100% !important;}div.mg_addad%id{text-align: right; opacity: 0.5;margin-right: 10px} div.mg_addad%id:hover{opacity: 1} div.mg_addad%id a{color: #000000; font:normal 10px Myriad Pro; text-decoration: none;} div.mg_addad%id img{margin-bottom: -5px; border:0px}</style>'; this.EYsUtm['4'] = '?utm_source=widget&utm_medium=text&utm_campaign=add&utm_content='; this.subnetDashboardDomains['4'] = '//dashboard.mgid.com'; this.YY.push("WU"); var informerData = []; informerData.push({"id": "5726", "etalonId": "0", "protocol": "5", "type": "News", "subnet": "0"}); informerData.push({"id": "3617", "etalonId": "0", "protocol": "5", "type": "Goods", "subnet": "0"}); this.WU = function() { for (var i = 0; i < informerData.length; i++) { var tickerId = informerData[i].etalonId != "0" && informerData[i].protocol == "4" ? informerData[i].etalonId : informerData[i].id; if ((informerData[i].subnet !== '1') ^ ('0' === '1')) { (function(type) { self.DF["MarketGidLoad" + type + tickerId] = function(json, awd) { self.SH = type.toLowerCase(); self.FD = '0'; self["MarketGidLoadNews"](json, awd); }; self.DF["MarketGidCReject12314"] = self['MarketGidReject']; })(informerData[i].type); if (informerData[i].protocol == "4") { self.DF["MarketGidRedirectComposite" + tickerId] = function() { self.FD = '0'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } else { self.DF["MarketGidRedirectComposite12314"] = function() { self.FD = '0'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } } if ((informerData[i].subnet !== '1') ^ ('1' === '1')) { (function(type) { self.DF["MarketGidLoad" + type + tickerId] = function(json, awd) { self.SH = type.toLowerCase(); self.FD = '1'; self["MarketGidLoadNews"](json, awd); }; self.DF["MarketGidCReject12314"] = self['MarketGidReject']; })(informerData[i].type); if (informerData[i].protocol == "4") { self.DF["MarketGidRedirectComposite" + tickerId] = function() { self.FD = '1'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } else { self.DF["MarketGidRedirectComposite12314"] = function() { self.FD = '1'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } } if ((informerData[i].subnet !== '1') ^ ('2' === '1')) { (function(type) { self.DF["AdskeeperLoad" + type + tickerId] = function(json, awd) { self.SH = type.toLowerCase(); self.FD = '2'; self["MarketGidLoadNews"](json, awd); }; self.DF["AdskeeperCReject12314"] = self['MarketGidReject']; })(informerData[i].type); if (informerData[i].protocol == "4") { self.DF["AdskeeperRedirectComposite" + tickerId] = function() { self.FD = '2'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } else { self.DF["AdskeeperRedirectComposite12314"] = function() { self.FD = '2'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } } if ((informerData[i].subnet !== '1') ^ ('3' === '1')) { (function(type) { self.DF["FeedboxLoad" + type + tickerId] = function(json, awd) { self.SH = type.toLowerCase(); self.FD = '3'; self["MarketGidLoadNews"](json, awd); }; self.DF["FeedboxCReject12314"] = self['MarketGidReject']; })(informerData[i].type); if (informerData[i].protocol == "4") { self.DF["FeedboxRedirectComposite" + tickerId] = function() { self.FD = '3'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } else { self.DF["FeedboxRedirectComposite12314"] = function() { self.FD = '3'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } } if ((informerData[i].subnet !== '1') ^ ('4' === '1')) { (function(type) { self.DF["MGidLoad" + type + tickerId] = function(json, awd) { self.SH = type.toLowerCase(); self.FD = '4'; self["MarketGidLoadNews"](json, awd); }; self.DF["MGidCReject12314"] = self['MarketGidReject']; })(informerData[i].type); if (informerData[i].protocol == "4") { self.DF["MGidRedirectComposite" + tickerId] = function() { self.FD = '4'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } else { self.DF["MGidRedirectComposite12314"] = function() { self.FD = '4'; self["MarketGidRedirectComposite"].apply(self, [].slice.call(arguments, 0)); }; } } } }; self.getSubnetByMirror = function(mirror) { var subnet = 0; if (typeof self.EYNames[mirror] != 'undefined') { subnet = self.EYNames[mirror]; } return subnet; }}; this['MarketGidCSubnetsBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Subnets'] = 'MarketGidCSubnetsBlock12314'; MarketGidCUtilsBlock12314 = function(self){ self.utils = {}; self.utils.getScroll = function() { return { top: self.DF.document.body.scrollTop || self.DF.document.documentElement.scrollTop || 0, left: self.DF.document.body.scrollLeft || self.DF.document.documentElement.scrollLeft || 0 } }; self.utils.getRect = function(element, withScroll) { var rect = element.getBoundingClientRect(); var toReturn = { top: rect.top, bottom: rect.bottom, left: rect.left, right: rect.right, height: (rect.height ? rect.height : rect.bottom - rect.top), width: (rect.width ? rect.width : rect.right - rect.left) }; if (withScroll) { var scroll = self.utils.getScroll(); toReturn.top += scroll.top; toReturn.bottom += scroll.top; toReturn.left += scroll.left; toReturn.right += scroll.left; } return toReturn; }; self.utils.getViewportSize = function() { return { width: (self.DF.innerWidth || self.DF.document.documentElement.clientWidth), height: (self.DF.innerHeight || self.DF.document.documentElement.clientHeight) }; }}; this['MarketGidCUtilsBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Utils'] = 'MarketGidCUtilsBlock12314'; MarketGidCMgqBlock12314 = function(self){ this.isLongCheck = false; this.YY.push("mgqInit"); this.mgqWorker = function() { var length = self.DF._mgq.length; var pool = self.DF._mgq.slice(0); for (var i = 0; i < length; i++) { var el = pool[i]; if (typeof(self.DF[el[0]]) == 'function') { self.DF[el[0]].apply(self.DF, el.slice(1)); self.DF._mgq.splice(i, 1); } } if (!self.DF._mgqi) { self.DF._mgqi = self.DF.setInterval(function() { self.mgqWorker(); }, 5); } if (!self.isLongCheck) { if ((new Date()).getTime() - self.DF._mgqt > 10000) { self.isLongCheck = true; self.DF.clearInterval(self.DF._mgqi); self.DF._mgqi = self.DF.setInterval(function() { self.mgqWorker(); }, 100); } } }; this.mgqInit = function() { self.DF._mgq = self.DF._mgq || []; if (typeof(self.DF._mgqp) == 'undefined') { self.DF._mgqp = self.mgqWorker; self.DF._mgqt = (new Date()).getTime(); self.mgqWorker(); } };}; this['MarketGidCMgqBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Mgq'] = 'MarketGidCMgqBlock12314'; MarketGidCDesktopDoubleClickBlock12314 = function(self){ var isTouch = (('ontouchstart' in window) || (navigator.msMaxTouchPoints > 0)); var isGoodBrowser = ('addEventListener' in window.document); if (!isTouch && isGoodBrowser){ this.ET.push("desktopDoubleClickHook"); this.informerId = 'MarketGidComposite12314'; this.ML( '.MarketGidDButton12314{' + 'display: inline-block;' + 'width: 80px;' + 'height: 80px;' + 'background-color: RGBA(0,0,0,0.4);' + 'border: 2px solid white;' + 'border-radius: 999px;' + 'color: white !important;' + 'font: normal 500 24px/80px "Sans", sans-serif;' + 'transform: scale3d(0.0001,0.0001,0.0001);' + 'text-align: center;' + 'text-shadow: none;' + 'position: absolute;' + 'text-decoration: none !important;' + 'transition:all 1s;'+ '}' + '.MarketGidDLayout12314{' + 'height: 100%;' + 'width: 100%;' + 'position: absolute;' + 'top: 0px;' + 'left: 0px;' + 'background-color: rgba(0, 0, 0, 0.5);' + 'z-index: 100;' + '}'+ '#MarketGidComposite12314 .mgline {position:relative}' ); } this.desktopDoubleClickHook = function(){ this.timeLoaded = parseInt((new Date()).getTime()/1000); var informer = this.DF.document.getElementById(this.informerId); informer.addEventListener("click", this.showDesktopDoubleClickButton.bind(this), false); }; this.showDesktopDoubleClickButton = function(event) { var clickedElement = event.target; var currentTime = parseInt((new Date()).getTime()/1000); var doubleClickDeactivationDelay = 10; if (clickedElement.className != 'MarketGidDButton12314' && (doubleClickDeactivationDelay === 0 || currentTime-this.timeLoaded < doubleClickDeactivationDelay)){ event.preventDefault(); while (clickedElement.tagName != 'A' && clickedElement.id != this.informerId) { clickedElement = clickedElement.parentNode; if (clickedElement.id == this.informerId) { return; } } var href = clickedElement.getAttribute('href'); clickedElement = event.target; while (clickedElement.className.indexOf('mgline') == -1) { clickedElement = clickedElement.parentNode; } var teaserDiv = clickedElement; var layoutDiv = this.DF.document.createElement('div'); layoutDiv.className = 'MarketGidDLayout12314'; var button = this.DF.document.createElement('a'); var buttonHeight = 80; var buttonWidth = 80; var top = (1-buttonHeight/teaserDiv.offsetHeight)/2*100; var scale = teaserDiv.offsetWidth/ buttonWidth*0.98; var symbol = navigator.userAgent.toLowerCase().match(/windows/) ? '&#187;' : '&#10093;'; button.innerHTML ='GO'; button.href = href; button.style.top = top+'%'; var left = scale > 1 ? (1-buttonWidth/teaserDiv.offsetWidth)/2*100 : 0; button.style.left = left+'%'; if (scale < 1){ button.style.transform = 'scale3d('+scale+','+scale+','+scale+')'; button.style.webkitTransform = 'scale3d('+scale+','+scale+','+scale+')'; button.style.transformOrigin = 'left'; button.style.webkitTransformOrigin = 'left'; } button.target = '_blank'; button.className = 'MarketGidDButton12314'; layoutDiv.appendChild(button); teaserDiv.appendChild(layoutDiv); setTimeout(function(){ scale = scale < 1 ? scale : 1; button.style.transform = 'scale3d('+scale+','+scale+','+scale+')'; }, 500); setTimeout(function(){layoutDiv.parentNode.removeChild(layoutDiv)}, 10000); } };}; this['MarketGidCDesktopDoubleClickBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['DesktopDoubleClick'] = 'MarketGidCDesktopDoubleClickBlock12314'; this['MarketGidCAntifraudBlock12314'] = function(self){ self.ET.push('VD'); self.YY.push('HY'); self.XI = null; self.WQ = null; self.BB = false; self.NA = ''; self.YU = ''; self.UJ = ''; self.DQ = ''; self.XE = ''; self.TC = ''; self.BM = ''; self.HC = ''; self.HY = function() { if (self.LX['svspr'] == undefined) { self.UJ = self.QV(self.DF.document.referrer, 500); self.LX['svspr'] = self.UJ; self.setCookie(); } else { self.UJ = self.LX['svspr']; } if (self.LX['svsds'] != undefined) { self.DQ = self.LX['svsds']; self.DQ++; } else { self.DQ = 1; } self.LX['svsds'] = self.DQ; self.setCookie(); var d = new Date(); self.NA = d.getTime() + '12314' + Math.floor(Math.random()*100) + '' + (2*Math.floor(Math.random()*4)); self.NA += 1; self.HC = d.getTime(); if (self.LX['TejndEEDj'] == undefined) { self.LX['TejndEEDj'] = self.x64String(self.NA); self.setCookie(); } }; self.x64String = function(s) { s = s.toString(); s = unescape(encodeURIComponent(s)); var b64c = '\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x24\x54\x55\x56\x57\x58\x59\x5a\x61\x62\x63\x64\x65\x2a\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2b\x2f\x3d'; var b64e = ''; var c1, c2, c3, c4, e1, e2, e3, e4; for (var i = 0; i < s.length;) { c1 = s.charCodeAt(i++); c2 = 2 << 5; e1 = c1 >> (c2 / 32); c3 = s.charCodeAt(i++); e2 = ((c1 & 3) << (c2 / 16)) | (c3 >> (c2 / 16)); c4 = s.charCodeAt(i++); e3 = isNaN(c3) ? c2 : (((c3 & 15) << (c2 / 32)) | (c4 >> (c2 - 58))); e4 = isNaN(c4) ? c2 : (c4 & (c2 - 1)); b64e += b64c.charAt(e1) + b64c.charAt(e2) + b64c.charAt(e3) + b64c.charAt(e4); } return b64e; }; self.KI = function(n) { return n ? Math.round(n).toString(16) : ''; }; self.QV = function(str, n) { return str.length > n ? str.substring(0, n) : str; }; self.getCoordsElementOfPage = function(element) { var offsetLeft = 0, offsetTop = 0; do { offsetLeft += element.offsetLeft; offsetTop += element.offsetTop; } while (element = element.offsetParent); return { 'x': offsetLeft, 'y': offsetTop }; }; self.getCoordsClickOfPage = function(event) { var x = 0, y = 0; if (!event) event = self.DF.event; if (event.pageX || event.pageY) { x = event.pageX; y = event.pageY; } else if (event.clientX || event.clientY) { x = event.clientX + (self.DF.document.documentElement.scrollLeft || self.DF.document.body.scrollLeft) - self.DF.document.documentElement.clientLeft; y = event.clientY + (self.DF.document.documentElement.scrollTop || self.DF.document.body.scrollTop) - self.DF.document.documentElement.clientTop; } return { 'x':x, 'y':y }; }; self.MH = function() { var ZU = 0; if (self.DF.opera) { ZU += 1; } if (self.DF.opera && self.DF.opera.buildNumber) { ZU += 2; } if (self.DF.document.all || self.DF.MSStream) { ZU += 4; } if (!self.DF.btoa || self.DF.navigator.msPointerEnabled) { ZU += 8; } if (self.DF.chrome) { ZU += 16; } if (self.DF.mozInnerScreenX != undefined) { ZU += 32; } if (!self.DF.external) { ZU += 64; } return ZU; }; self.JV = function() { return window.navigator.javaEnabled() }; self.HG = function() { var flashEnabled = false; if (typeof(navigator.plugins) != 'undefined' && typeof(navigator.plugins["Shockwave Flash"]) == 'object') { flashEnabled = true; } else if (typeof window.ActiveXObject != 'undefined') { try { if (new ActiveXObject('ShockwaveFlash.ShockwaveFlash')) { flashEnabled = true; } } catch(e) {} } return flashEnabled; }; self.WT = function(event, element) { if (false == self.BB) { return; } var element = element || self.DF.document.createElement('A'); var event = event || self.DF.document.createEvent('MouseEvent'); var date = new Date(); var coordClickOfPage = self.getCoordsClickOfPage(event); var b = element.getBoundingClientRect(); var IT = self.getCoordsElementOfPage(element); var d = self.DF.document; var ZU = self.MH(); var DU = ''; for (var i = 1; i <= Math.ceil((ZU + 1) / 68) * 31; i++) { if ((i % 26 == 0) || ((i % 26 == 6) && (((i % 26) + 5) % 11 == 0))) { continue; } DU += (i == 1 ? '' : String.fromCharCode(102)) + String.fromCharCode(96 + (i % 26)) + String.fromCharCode(83); var ZC = ''; if (i > 31) { break; } switch (i) { case 1: ZC = self.NA; break; case 2: ZC = self.KI(b.bottom); break; case 3: ZC = self.KI(self.HC); break; case 4: ZC = self.KI(date.getTime()); break; case 5: ZC = self.KI(d.body.clientheight); break; case 7: ZC = self.KI(event.clientX); break; case 8: ZC = self.KI(event.clientY); break; case 9: ZC = self.KI(b.left); break; case 10: ZC = self.KI(self.WQ); break; case 11: ZC = self.KI(b.top); break; case 12: ZC = self.KI(d.body.clientheight - event.clientY); break; case 13: ZC = self.KI(b.right - b.left); break; case 14: ZC = self.KI(b.bottom - b.top); break; case 15: ZC = self.BM; break; case 16: ZC = self.KI(event.clientY); break; case 17: ZC = self.KI(ZU); break; case 18: ZC = self.KI(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); break; case 19: ZC = self.QV(d.location.href, 500); break; case 20: ZC = self.QV(d.referrer, 500); break; case 21: ZC = self.UJ; break; case 22: ZC = self.KI(self.DQ); break; case 23: ZC = self.KI(coordClickOfPage.x); break; case 24: ZC = self.KI(coordClickOfPage.y); break; case 25: ZC = self.KI(IT.x); break; case 27: ZC = self.KI(IT.y); break; case 28: ZC = self.KI(self.JV()); break; case 29: ZC = self.KI(self.HG()); break; case 30: ZC = self.KI(window.screen.width); break; case 31: ZC = self.KI(window.screen.height); break; } DU += self.x64String(ZC); } return encodeURIComponent(DU); }; self.EH = function(event, element) { if (!event) var event = self.DF.event; if (!event.target) { event.target = event.srcElement; } var hash = element['data-hash'] || element.getAttribute('data-hash'); if (typeof(hash) == 'undefined' || element.tagName != 'A') { return; } element.href = self.JT(hash, event, element); }; self.BC = function(event) { if (!event) var event = self.DF.event; if (!event.target) { event.target = event.srcElement; } self.BB = true; var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } self.EH(event, element); self.DF.setTimeout(function() { self.BB = false; self.EH(event, element); }, 100); }; self.VK = function(event) { if (!event) var event = self.DF.event; if (!event.target) { event.target = event.srcElement; } self.BB = true; var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if (v % 2 != 1) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 1; } self.EH(event, element); }; self.QF = function(event) { if (!event) var event = self.DF.event; if (!event.target) { event.target = event.srcElement; } self.WQ = 0; self.DF.clearInterval(self.XI); self.XI = self.DF.setInterval(function() { self.WQ++; }, 1000); }; self.RS = function(event) { if (!event) var event = self.DF.event; if (!event.target) { event.target = event.srcElement; } self.BB = true; var element = event.target; if (element.tagName != 'A') { var element = self.getParentLink(element); if (null == element) { return; } } if (!element.hasAttribute('data-hash')) { return; } var v = 0; if (parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C'])) { v = parseInt(element['\x64\x61\x74\x61\x2d\x72\x65\x6C']); } if ((v >> 1) % 2 != 1) { element['\x64\x61\x74\x61\x2d\x72\x65\x6C'] = v + 2; } self.EH(event, element); }; self.VD = function(element) { if (typeof element == 'undefined') { element = self.root; } self.addEvent(element, "mouseup", self.BC); self.addEvent(element, "mouseover", self.VK); self.addEvent(element, "mousemove", self.RS); self.addEvent(self.DF.document, "scroll", self.QF); };}; this['MarketGidCAntifraudBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Antifraud'] = 'MarketGidCAntifraudBlock12314'; MarketGidCDiscountBlock12314 = function(self){ this.ET.push("JB"); this.NX = function(event) { self.helpIE(this); var pricesold = this.getElementsByClassName('mcpriceold3617'); var prices = this.getElementsByClassName('mcprice3617'); var discounts = this.getElementsByClassName('mcdiscount3617'); if (pricesold.length > 0) { pricesold[0].style.display = 'none'; prices.length > 1 ? prices[1].style.display = 'none' : null; discounts.length > 0 ? discounts[0].style.display = 'inline' : null; } }; this.TY = function(event) { self.helpIE(this); var discounts = this.getElementsByClassName('mcdiscount3617'); var prices = this.getElementsByClassName('mcprice3617'); var pricesold = this.getElementsByClassName('mcpriceold3617'); if (pricesold.length > 0) { discounts.length > 0 ? discounts[0].style.display = 'none' : null; prices.length > 1 ? prices[1].style.display = 'inline' : null; pricesold[0].style.display = 'inline'; } }; this.JB = function() { if (this.root) { this.helpIE(this.root); var teasers = this.root.getElementsByClassName('mcteaser3617'); } for (var MG_t in teasers) { teasers[MG_t].onmouseout = this.TY; teasers[MG_t].onmouseover = this.NX; } }; this.helpIE = function(el) { if (el.getElementsByClassName == undefined) { el.getElementsByClassName = function(cl) { var retnode = []; var myclass = new RegExp('\\b'+cl+'\\b'); var elem = this.getElementsByTagName('*'); for (var i = 0; i < elem.length; i++) { var classes = elem[i].className; if (myclass.test(classes)) retnode.push(elem[i]); } return retnode; }; } }; }; this['MarketGidCDiscountBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Discount'] = 'MarketGidCDiscountBlock12314'; MarketGidCCountersBlock12314 = function(self){ this.YY.push("VP"); this.VP = function() { }; this.ET.push("compositeComscoreCountersLoad"); this.compositeComscoreCountersLoad = function() { if(!this.comscoreCompositeCounter){ this.comscoreCompositeCounter=true; this.DF._comscore = this.DF._comscore||[]; var mirrorStr = ((this.SH=='news') ? ('0' + '10') : ('1' + '10')); this.DF._comscore.push({ c1: "7", c2:"15208452", c3:mirrorStr, c4: this.blockId }); (function(){var s = MarketGidInfC12314.DF.document.createElement("script"), el = MarketGidInfC12314.DF.document.getElementsByTagName("script")[0]; s.async = true; var scriptSrc = (MarketGidInfC12314.DF.document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";s.src=scriptSrc; el.parentNode.insertBefore(s, el); })(); } }; }; this['MarketGidCCountersBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Counters'] = 'MarketGidCCountersBlock12314'; this['MarketGidCAdvertLinkBlock12314'] = function(self) { self.WJ.push("refreshAdvertLink"); self.refreshAdvertLink = function() { if (parseInt('0')) { try { var adLinkBlock = self.EYsAdLinkBlocks[self.FD].replace(/%id/g, '12314'); adLinkBlock = adLinkBlock.replace( "%WIDGET_TITLE%", "Promoted Content" || "" ); var utm = ''; if (utm == '') { utm = self.EYsUtm[self.FD]; } self.TZ = adLinkBlock.replace(/%utm/, utm); } catch (e) { } } else { self.TZ = ''; } }; self.parseAdvertLink = function(template) { var marker = '<!--advertPrefix-->'; var isMarkerInTheSecondPart = template.indexOf(marker) > (template.length / 2); if (isMarkerInTheSecondPart) { self.fixGetElementsByClassNameHandler(self.root); var elements = self.root.getElementsByClassName('mg_addad12314'); for (var i = 0; i < elements.length; i++) { elements[i].parentNode.removeChild(elements[i]); } } if (isMarkerInTheSecondPart || self.KE == 0) { if (template.indexOf(marker) >= 0) { template = template.replace(marker, this.TZ); } else { template = self.TZ + template; } } return template; };}; this['MarketGidCAdvertLinkBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['AdvertLink'] = 'MarketGidCAdvertLinkBlock12314'; this['MarketGidCRejectBlock12314'] = function(self) { self.isInsertedRejectStyles = false; self['MarketGidReject'] = function () { var url = self.subnetDashboardDomains[self.getSubnetByMirror('marketgid')]; if ('C' == 'C') { url += '/publishers/blocked'; } else { url += '/audience-development/blocked'; } var widget = self.blockType == 'news' ? '69822' : '30491'; self.fixGetElementsByClassNameHandler(self.root); var mglines = self.root.getElementsByClassName('mgline'); for (var i = 0; i < mglines.length; i++) { (function(mgline) { if (mgline.className.indexOf('dsp') >= 0) { return; } self.fixGetElementsByClassNameHandler(mgline); var imgList = mgline.getElementsByClassName('mcimg'); var img = false; for (var j = 0; j < imgList.length; j++) { if (imgList[j].tagName == "DIV") { img = imgList[j]; break; } } if (!img) { return; } self.fixGetElementsByClassNameHandler(img); var el = img.getElementsByClassName('close-informer'); var match = mgline.className.match(/teaser-([0-9]+)/); if (null == match) { return; } if (el.length == 0) { var a = self.DF.document.createElement('a'); var imgStyles = self.DF.getComputedStyle(img); a.className = "close-informer"; a.href = url + '/teaser/' + match[1] + '/widget/' + widget + '/type/' + self.blockType; a.target = '_blank'; a.rel = "nofollow"; a.style.top = (parseInt(imgStyles.borderTopWidth) + 3) + 'px'; a.style.right = (parseInt(imgStyles.borderRightWidth) +3) + 'px'; img.style.position = "relative"; img.appendChild(a); } })(mglines[i]); } }; self.initRejectStyles = function() { if (self.isInsertedRejectStyles) { return; } var rejectStyles = '\ div.mcimg a.close-informer {\ width: 14px;\ height: 14px;\ background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NzI0ODBDMzY3ODcxMUU1OEM4RUU2RUJCOUREODIyQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NzI0ODBDNDY3ODcxMUU1OEM4RUU2RUJCOUREODIyQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjk3MjQ4MEMxNjc4NzExRTU4QzhFRTZFQkI5REQ4MjJCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjk3MjQ4MEMyNjc4NzExRTU4QzhFRTZFQkI5REQ4MjJCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+uNcpEQAAAHxJREFUeNqckgEKwCAIRe3fYjfKc2zX6hydaLRbbDnGkLDIPggl/5lKIcbIRJRqbDSnUmOHE6LPm+CEfhj6lnN+o5WVh1VOm6xColCXc/cgLWYev9gaejnQojCab5RDzyDt6RantqoBaz5zq54ZywJ3CXjIwQGd8skfAQYALdQqftYulocAAAAASUVORK5CYIJ0ZW50Ij4NCiA8ZGl2IGNsYXNzPSJjb250ZW50LWNvbnRhaW5lciI+PGZpZWxkc2V0Pg0KICA8aDI+NTAyIC0gV2ViIHNlcnZlciByZWNlaXZlZCBhbiBpbnZhbGlkIHJlc3BvbnNlIHdoaWxlIGFjdGluZyBhcyBhIGdhdGV3YXkgb3IgcHJveHkgc2VydmVyLjwvaDI+DQogIDxoMz5UaGVyZSBpcyBhIHByb2JsZW0gd2l0aCB0aGUgcGFnZSB5b3UgYXJlIGxvb2tpbmcgZm9yLCBhbmQgaXQgY2Fubm90IGJlIGRpc3BsYXllZC4gV2hlbiB0aGUgV2ViIHNlcnZlciAod2hpbGUgYWN0aW5nIGFzIGEgZ2F0ZXdheSBvciBwcm94eSkgY29udGFjdGVkIHRoZSB1cHN0cmVhbSBjb250ZW50IHNlcnZlciwgaXQgcmVjZWl2ZWQgYW4gaW52YWxpZCByZXNwb25zZSBmcm9tIHRoZSBjb250ZW50IHNlcnZlci48L2gzPg0KIDwvZmllbGRzZXQ+PC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4NCg==");\ display: block;\ opacity: 0;\ position: absolute;\ right: 3px;\ top: 3px;\ z-index: 1;\ cursor: pointer;\ }\ div.mgline:hover a.close-informer {\ opacity: 0.7;\ -moz-transition: all 0.3s ease-out;\ -o-transition: all 0.3s ease-out;\ -webkit-transition: all 0.3s ease-out;\ -ms-transition: all 0.3s ease-out;\ transition: all 0.3s ease-out;\ }\ div.mgline a.close-informer:hover {\ opacity: 1;\ -moz-transition: all 0.3s ease-out;\ -o-transition: all 0.3s ease-out;\ -webkit-transition: all 0.3s ease-out;\ -ms-transition: all 0.3s ease-out;\ transition: all 0.3s ease-out;\ }\ div.mcimg {\ position: relative;\ display: inline-block\ }\ div.image-with-price {\ position: relative;\ }\ .mgline .image-container {\ width: auto;\ margin: 0 auto;\ display: table;\ position: relative;\ }'; if ('C' == 'C') { self.stylesNews += rejectStyles; self.stylesGoods += rejectStyles; } else { self.styles += rejectStyles; } self.isInsertedRejectStyles = true; }; self.WJ.push('initRejectStyles');}; this['MarketGidCRejectBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Reject'] = 'MarketGidCRejectBlock12314'; MarketGidCSendDimensionsBlock12314 = function(self){ self.blankImage = "data:image/gif;base64,R0lGODlhyADIAPAAAAAAAAAAACH5BAEAAAAALAAAAADIAMgAAAL+hI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8YhMKpfMpvMJjUqn1Kr1is1qt9yu9wsOi8fksvmMTqvX7Lb7DY/L5/S6/Y7P6/f8vv8PGCg4SFhoeIiYqLjI2Oj4CBkpOUlZaXmJmam5ydnp+QkaKjpKWmp6ipqqusra6voKGys7S1tre4ubq7vL2+v7CxwsPExcbHyMnKy8zNzs/AwdLT1NXW19jZ2tvc3d7f0NHi4+Tl5ufo6err7O3u7+Dh8vP09fb3+Pn6+/z9/v/w8woMCBBAsaPIgwocKFDBs6fAgxosSJFCtavIgxo8YHjRw7eixTAAA7"; self.precalcRect = {}; self.updatePrecalcRect = function() { self.SH = "news"; self.FD = '0'; self.fakeMode = true; var realRoot = self.root; var cnt = self.DF.document.createElement('div'); var newRoot = self.DF.document.createElement('div'); newRoot.id = self.root.id; self.root.id += "_"; cnt.appendChild(newRoot); self.root.appendChild(cnt); self.root = newRoot; realRoot.style.height = "0px"; realRoot.style.overflow = "hidden"; var countNews = 8; var lorem = "Lorem ipsum dolor sit amet Lorem ipsum dolor sit amet"; var data = []; for (var i = 1; i <= countNews; i++) { data.push(['', i,'', lorem, lorem, '', '', {i: self.blankImage}]); } self.MarketGidLoadNews(data); var h = self.SR(); self.fixGetElementsByClassNameHandler(self.root); var widgetRect = self.root.getBoundingClientRect(); if (self.root.getElementsByClassName("mgbox")[0]) { widgetRect = self.root.getElementsByClassName("mgbox")[0].getBoundingClientRect(); } self.precalcRect.width = parseInt(widgetRect.width ? widgetRect.width : widgetRect.right - widgetRect.left); self.precalcRect.height = parseInt(widgetRect.height ? widgetRect.height : widgetRect.bottom - widgetRect.top); self.precalcRect.top = widgetRect.top; self.precalcRect.bottom = widgetRect.bottom; self.requestParams.w = "w=" + self.precalcRect.width; self.requestParams.h = "h=" + self.precalcRect.height; var cols = 0; var elx = self.root.getElementsByClassName('mgline'); for (i = 0; i < elx.length; i++) { var rect = elx[i].getBoundingClientRect(); if (prepTop != undefined && prepTop < rect.top) { cols = i; break; } var prepTop = rect.top; } if (cols == 0) { cols = elx.length; } self.requestParams.cols = "cols=" + cols; self.fakeMode = false; self.root = realRoot; self.root.removeChild(cnt); self.root.id = self.root.id.substr(0, self.root.id.length - 1); self.root.style.height = "auto"; self.root.style.overflow = "visible"; self.SH = ""; self.FD = ""; self.KE = 0; self.template = ""; self.iteration = 1; self.OV = {}; }; this.YY.push("updatePrecalcRect");}; this['MarketGidCSendDimensionsBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['SendDimensions'] = 'MarketGidCSendDimensionsBlock12314'; MarketGidCMonitorBlock12314 = function(self){ this.ET.push("monitorInit"); this.shownBlocks = {}; this.monitorInterval = null; this.isFirstCappingRequest = true; this.monitorInit = function() { var regex = /\/\/img.*\/[\d]+\/([\d]+).*\.(jpg|gif)/; if (!this.monitorInterval) { this.monitorInterval = self.DF.setInterval(function() { var newBlocks = {}; var viewportSize = self.utils.getViewportSize(); var images = self.root.getElementsByTagName('IMG'); for (var i = 0; i < images.length; i++) { if (self.isElementInViewport(images[i])) { var res = regex.exec(images[i].src); if (!res){ if (images[i].dataset.i){ res = []; res[1] = images[i].dataset.i; } } if (res && res[1] && !self.shownBlocks[res[1]]) { var teaserBlock = self.getParentTeaserBlock(images[i]); var imageRect = self.utils.getRect(images[i], true); if (teaserBlock) { var teaserDims = self.utils.getRect(teaserBlock, true); newBlocks[res[1]] = { width: Math.round(imageRect.width), height: Math.round(imageRect.height), atf: teaserDims.top < viewportSize.height, align: self.getTeaserAlign(teaserDims), desc: self.isTeaserElementVisible(teaserBlock, 'mcdesc'), price: self.isTeaserElementVisible(teaserBlock, 'mcprice'), domain: self.isTeaserElementVisible(teaserBlock, 'mcdomain') }; } else { newBlocks[res[1]] = { width: Math.round(imageRect.width), height: Math.round(imageRect.height), desc: false, price: false, domain: false }; } self.shownBlocks[res[1]] = 1; } } } self.prepareCappingData(newBlocks); }, 1000); } }; this.prepareCappingData = function(blocks) { var typePrefix = "&t=" + (self.SH == 'news' ? "N" : "G"); var data = ""; var counter = 0; for (var i in blocks) { var prefix = blocks[i].width + "|" + blocks[i].height + "|" + ( (blocks[i].desc ? 1 : 0) + (blocks[i].price ? 2 : 0) + (blocks[i].domain ? 4 : 0) + (blocks[i].atf ? 8 : 0) + (blocks[i].align == 'right' ? 16 : 0) + (blocks[i].align == 'left' ? 32 : 0)) + "|"; data += "&v=" + prefix + self.teaserHashes[i]; counter++; if (counter > 20) { self.sendCappingData(typePrefix + data); data = ""; counter = 0; } } if (data != "") { self.sendCappingData(typePrefix + data); } }; this.sendCappingData = function(data) { var img = document.createElement('IMG'); if (self.isFirstCappingRequest) { data = "&f=1" + data; self.isFirstCappingRequest = false; } var scriptSrc = "//c.mgid.com/c?pv=2" + data; img.src = scriptSrc; img.onerror = function () { if (typeof(mg_ws)=="object" && mg_ws instanceof WebSocket){ mg_ws.onmessage = function(evt){}; sendMessage('c|'+scriptSrc); } }; }; this.isElementInViewport = function(el) { var rect = el.getBoundingClientRect(); var viewport = self.utils.getViewportSize(); return ( rect.bottom - rect.top > 0 && rect.right - rect.left > 0 && rect.top >= 0 && rect.left >= 0 && rect.bottom <= viewport.height && rect.right <= viewport.width ); }; this.getParentTeaserBlock = function(el) { var current = el; while (current != self.root && current != self.DF) { if (current.className.indexOf("mgline") >= 0) { return current; } else { current = current.parentNode; } } return null; }; this.isTeaserElementVisible = function(el, className) { self.fixGetElementsByClassNameHandler(el); var elements = el.getElementsByClassName(className); if (elements.length > 0) { var dims = elements[0].getBoundingClientRect(); if (dims.right - dims == 0 || dims.bottom - dims.top == 0) { return false; } else { return true; } } else { return false; } }; this.getTeaserAlign = function(teaserDims) { var bodyWidth = self.DF.document.body.scrollWidth; if (teaserDims.right < 0.3 * bodyWidth) { return 'left'; } else if (teaserDims.left >= 0.7 * bodyWidth) { return 'right' } else { return 'center'; } };}; this['MarketGidCMonitorBlock12314'].call(this['MarketGidInfC12314'], this['MarketGidInfC12314']); this['MarketGidInfC12314']['funcBlocks']['Monitor'] = 'MarketGidCMonitorBlock12314'; MarketGidInfC12314.init(); MarketGidInfC12314.start(); }